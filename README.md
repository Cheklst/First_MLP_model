# Применение нейронных сетей для составления предложений по аренде жилья

Данный репозиторий включает в себя учебный проект по созданию нейронной сети для предсказания
арендной платы по определенным признакам. Выполнен при помощи языка Python и библиотек
TensorFlow/Keras, Matplotlib, seaborn, pandas, numpy и sklearn.

## Оглавление
1.  [Описание проекта](#описание-проекта)
2.  [Используемые технологии](#используемые-технологии)
3.  [Структура данных датасета](#структура-данных-датасета)
4.  [Этапы работы](#этапы-работы)
5.  [Архитектура моделей](#архитектура-моделей)
6.  [Результаты](#результаты)

## Описание проекта
В качестве задачи было выбрано прогнозирование цены на аренду жилья по определенным критериям конкретной квартиры. 

## Используемые технологии
*   **Язык:** Python
*   **Библиотеки для обработки данных:** Pandas, NumPy
*   **Библиотеки для машинного обучения:** scikit-learn
*   **Библиотеки для визуализации:** matplotlib, seaborn
*   **Фреймворк глубокого обучения:** TensorFlow/Keras
*   **Среды разработки:** Google Colab / PyCharm

## Структура данных датасета
Исходный датасет `House_Rent_Dataset.csv` (https://www.kaggle.com/datasets/iamsouravbanerjee/house-rent-prediction-dataset) содержит следующие ключевые признаки:

| Название поля        | Описание                                                                                              |
| :------------------- | :---------------------------------------------------------------------------------------------------- |
| **Posted On**        | Дата публикации предложения по аренде.                                                                |
| **BHK**              | Количество спален, гостиных, кухонь.                                                                  |
| **Rent**             | **Целевой параметр.** Арендная плата.                                                                 |
| **Size**             | Площадь квартиры/дома в квадратных футах.                                                             |
| **Floor**            | Этаж, на котором располагается квартира и общее количество этажей.                                    |
| **Area Type**        | Площадь квартиры/дома, рассчитанная на основе общей площади, жилой площади или площади застройки.     |
| **Area Locality**    | Местоположение квартиры/дома.                                                                         |
| **City**             | Город, в котором располагается дом/квартира.                                                          |
| **Furnishing Status**| Статус наличия мебели в доме/квартире.                                                                |
| **Tenant Preferred** | Тип арендатора, предпочитаемый владельцем или агентом.                                                |
| **Bathroom**         | Количество ванных комнат.                                                                             |
| **Point of Contact** | Тип контактного лица для связи по предложению.                                                        |
Перед обработкой были удалены столбцы `Posted On`, `Tenant Preferred`, `Point of Contact`, а так же разделен столбец `Floor` на два независимых.

## Этапы работы
1.  **Первичный анализ:** Исследование структуры данных, проверка на пропуски, удаление не нужных параметров.
2.  **`Floor` был разделён на два числовых признака: `floor_number` (этаж квартиры) и `total_floor` (всего этажей в доме). Строковые значения (`ground`, `basement`) конвертированы в числа.**
3.  **Обработка целевой переменной (Rent):**
    *   Для борьбы с выбросами применено логарифмирование: `Rent_log = log(1 + Rent)`.
    *   К полученным значениям применён метод IQR для приравнивания выбросов к крайним значениям.
4.  **Подготовка признаков:**
    *   **Числовые признаки** стандартизированы с помощью `StandardScaler`.
    *   **Категориальные признаки:**
        *   `Area Type`, `Furnishing Status`, `City` закодированы с помощью метода One-Hot Encoding.
        *   `Area Locality` закодирован с помощью `TargetEncoder`.
5.  **Разделение данных:** Данные разделены на обучающую и тестовую выборки в соотношении 80/20.
6.  **Разработка нейронной сети:** Построена, обучена и оценена базовая версия нейронной модели. Впоследствии создана вторая версия с улучшениями.

## Архитектура моделей

### 1. Базовая модель
Полносвязная сеть с двумя скрытыми слоями и Dropout для регуляризации.

1. Input Layer (15 признаков)
2. Dense(128, activation="relu") + Dropout(0.3)
3. Dense(64, activation="relu") + Dropout(0.3)
4. Dense(1, activation="linear")

### 2. Улучшенная модель
Усовершенствованная модель, включающая Batch Normalization и функцию активации LeakyReLU для более стабильного и быстрого обучения.

1. Input Layer (15 признаков)
2. BatchNormalization()
3. Dense(128) + BatchNormalization() + LeakyReLU(alpha=0.2) + Dropout(0.3)
4. Dense(64) + BatchNormalization() + LeakyReLU(alpha=0.2) + Dropout(0.3)
5. Dense(1, activation="linear")

**Параметры обучения моделей:**
*   Оптимизатор: Adam (learning_rate=0.001)
*   Функция потерь: Mean Squared Error (MSE)
*   Метрики: MAE, MSE
*   Эпохи: 200
*   Размер батча: 32
*   Validation Split: 20% от обучающей выборки

## Результаты
Результаты моделей:

| Модель                | MAE (₹) | RMSE (₹) | R² Score |
|:----------------------| :---: | :---: | :---: |
| **Базовая модель**    | `10709.77` | `27486.97` | `0.81` |
| **Улучшенная модель** | `9992.19` | `25385.81` | `0.84` |

**Выводы:**
*   Улучшенная модель показала себя лучше в предсказании цен на аренду по сравнению с базовой.
*   Из полученных графиков следует, что улучшенная модель обучается стабильнее и быстрее.
